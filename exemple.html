<!DOCTYPE HTML>
<html lang="fr-FR">
<head>
	<meta charset="UTF-8">
	<title>Demo Bing Map</title>
	<!--<script charset="UTF-8" type="text/javascript" src="https://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0"></script>-->
	<script charset="UTF-8" type="text/javascript" src="https://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0"></script>
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
	
	<script type="text/javascript" src="js/shCore.js"></script>
 
		<!--
		    At least one brush, here we choose JS. You need to include a brush for every 
		    language you want to highlight
		-->
		<script type="text/javascript" src="css/shBrushJScript.js"></script>
		<!-- Include *at least* the core style and default theme -->
		<link href="css/shCore.css" rel="stylesheet" type="text/css" />
		<link href="css/shThemeDefault.css" rel="stylesheet" type="text/css" />
	<script type="text/javascript">
     SyntaxHighlighter.all();
</script>

	<style type="text/css">
		.wrap{
			width: 900px;
			margin: 10px auto;
			padding: 15px
		}
		.clear{clear: both; visibility: hidden; margin: 10px 0}
	

		.mapl{
			width: 430px;
			height: 300px;
			margin-right: 20px;
			float: left;
		}
		.mapr{
			width: 430px;
			height: 300px;
			float: left;
		}
		.codeshow{
			font-size: 13px;
			word-wrap: break-word;
			width: 430px;
			float: left;
		}
		.codeshow + .codeshow{margin-left: 20px}
	</style>
</head>
<body>
	<div class="wrap">
		
		<div id="map1" class="mapl"></div><div id="map2" class="mapr"></div>
		<hr class="clear">

		<div class="codeshow">
			<pre class="brush: js">$('#map1').bingmap({
			api: credentials,
			width: $('#map1').innerWidth(),
			height: $('#map1').innerHeight(),
			disable_zoom: false

		});</pre>
		</div>
		<div class="codeshow">
			<pre class="brush: js">$('#map2').bingmap({
			api: credentials,
			width: $('#map2').innerWidth(),
			height: $('#map2').innerHeight(),
			zoom: 15,
			type: "sky",
			disable_navigate: false
		});</pre>
		</div>

		<hr class="clear">
		<div id="map3" class="mapl"></div><div id="map4" class="mapr"></div>
		<hr class="clear">
		<div class="codeshow">
			<pre class="brush: js">$('#map3').bingmap({
			api: credentials,
			width: $('#map1').innerWidth(),
			height: $('#map1').innerHeight(),
			type: "road",
			zoom: 10,
			disable_zoom: false, 
			disable_navigate: false,
			latitude : 48.76218347089439,
			longitude : 2.2769074707031445,
			pin : [{
					lat: 48.733,
					lng: 2.233,
					drag: true
				},{
					lat: 48.783,
					lng: 2.303
				}],
			onFinish : function(obj){
				Microsoft.Maps.Events.addHandler(obj.pin[0], 'dragend', displayEventInfo);
				function displayEventInfo(e) {
					alert("Nous sommes au point de latutude : " +e.entity._location.latitude+ "et de longitude : "+e.entity._location.longitude);
				       console.log(e.entity._location.latitude);
					console.log(e.entity._location.longitude);
				   }
			}
		});</pre>
		</div>
		<div class="codeshow">
			<pre class="brush: js">$('#map4').bingmap({
			api: credentials,
			width: $('#map4').innerWidth(),
			height: $('#map4').innerHeight(),
			type: "bird",
			zoom: 10,
			latitude : 48.76218347089439,
			longitude : 2.2769074707031445,
			pin : [{
					lat: 48.733,
					lng: 2.233,
					
				},{
					lat: 48.783,
					lng: 2.303,drag: true
				}],
			onFinish : function(obj) {
				Microsoft.Maps.Events.addHandler(obj.pin[1], 'dragend', displayEventInfo);
				function displayEventInfo(e) {
					alert("Nous sommes au point de latutude : " +e.entity._location.latitude+ "et de longitude : "+e.entity._location.longitude);
				       console.log(e.entity._location.latitude);
					console.log(e.entity._location.longitude);
				   }
			}
		});</pre>
		</div>

		<hr class="clear">
		<div id="map5" class="mapl"></div><div id="map6" class="mapr"></div>
		<hr class="clear">


	</div>
</body>
<script charset="UTF-8" type="text/javascript" src="bingmap.js"></script>
<script type="text/javascript">
		
		var credentials = 'AtZVaPeWtqEJ7xglZZZ6WZJkMihxHRlweOWszXf0Oh7kf7SEQz1qT-jCDlGw9UAW';

		$('#map1').bingmap({
			api: credentials,
			width: $('#map1').innerWidth(),
			height: $('#map1').innerHeight(),
			disable_zoom: false

		});

		$('#map2').bingmap({
			api: credentials,
			width: $('#map2').innerWidth(),
			height: $('#map2').innerHeight(),
			zoom: 15,
			type: "sky",
			disable_navigate: false
		});

		$('#map3').bingmap({
			api: credentials,
			width: $('#map1').innerWidth(),
			height: $('#map1').innerHeight(),
			type: "road",
			zoom: 10,
			disable_zoom: false, 
			disable_navigate: false,
			latitude : 48.76218347089439,
			longitude : 2.2769074707031445,
			pin : [{
					lat: 48.733,
					lng: 2.233,
					drag: true
				},{
					lat: 48.783,
					lng: 2.303
				}],
			onFinish : function(obj)
			{
				Microsoft.Maps.Events.addHandler(obj.pin[0], 'dragend', displayEventInfo);
				function displayEventInfo(e) {
					alert("Nous sommes au point de latutude : " +e.entity._location.latitude+ "et de longitude : "+e.entity._location.longitude);
				       console.log(e.entity._location.latitude);
					console.log(e.entity._location.longitude);
				   }
			}
		});


		$('#map4').bingmap({
			api: credentials,
			width: $('#map4').innerWidth(),
			height: $('#map4').innerHeight(),
			type: "bird",
			zoom: 10,
			latitude : 48.76218347089439,
			longitude : 2.2769074707031445,
			pin : [{
					lat: 48.733,
					lng: 2.233					
				},{
					lat: 48.783,
					lng: 2.303,drag: true
				}],
			onFinish : function(obj)
			{
				Microsoft.Maps.Events.addHandler(obj.pin[1], 'dragend', displayEventInfo);
				function displayEventInfo(e) {
					alert("Nous sommes au point de latutude : " +e.entity._location.latitude+ "et de longitude : "+e.entity._location.longitude);
				       console.log(e.entity._location.latitude);
					console.log(e.entity._location.longitude);
				   }
			}
		});

		if(navigator.geolocation){
		    navigator.geolocation.getCurrentPosition(function(position){
		    	var points = position.coords.latitude+ ',' +position.coords.longitude;
		    	demo(points,credentials,position.coords.latitude,position.coords.longitude);
		    });
		   
		}

		function demo(point,credentials, lat,lng){
			$.ajax({
	            url: "http://dev.virtualearth.net/REST/v1/Locations",
	            dataType: "jsonp",
	            data: {
	                key: credentials,
	                q: point
	            },
	            jsonp: "jsonp",
	        }).done(function(e){
	           showMap(e.resourceSets[0].resources[0].address,lat,lng);
	        });


		}

		function showMap(obj,lat,lng){
			
			$('#map5').bingmap({
				api: credentials,
				width: $('#map5').innerWidth(),
				height: $('#map5').innerHeight(),
				zoom: 10,
				latitude : lat,
				longitude : lng,
				pin : [{
						lat: lat,
						lng: lng,
						title : 'Ma localisation',
						width: 150,
						height: 50,
						onShow: true
					},
					{
						lat: 48.76218347089439,
						lng: 2.2769074707031445,
						title : 'Ma localisation 2',
						width: 150,
						height: 50
					}],
				
				});
		}
		function GeocodeCallback(result) {   
           console.log(result.resourceSets[0].resources[0].address);
        }

		//MakeGeocodeRequest(48.76218347089439,2.2769074707031445,'AtZVaPeWtqEJ7xglZZZ6WZJkMihxHRlweOWszXf0Oh7kf7SEQz1qT-jCDlGw9UAW');
		
		function MakeGeocodeRequest(lat,lng,credentials)
        {
           var geocodeRequest = "http://dev.virtualearth.net/REST/v1/Locations/"+lat+","+lng+"?o=json&jsonp=GeocodeCallback&key=" + credentials;

           CallRestService(geocodeRequest);
        }

        function CallRestService(request) 
        {
           var script = document.createElement("script");
           script.setAttribute("type", "text/javascript");
           script.setAttribute("src", request);
           document.body.appendChild(script);
        }
        /*function GeocodeCallback(result) 
        {   
           console.log(result);
        }
*/
	</script>
</html>